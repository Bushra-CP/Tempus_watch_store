<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Admin Tempus</title>
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css"
      rel="stylesheet"
    />
    <link
      rel="stylesheet"
      href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.css"
    />
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <link rel="stylesheet" href="/css2/demo.css" />
  </head>

  <body class="bg-light">
    <!--topBar-->
    <%- include('../../views/partials/admin/topBar')%>
    <!--topBar-->

    <!-- Main Content -->
    <div class="main-content">
      <!--topBar-->
      <%- include('../../views/partials/admin/sideBar')%>
      <!--topBar-->
      <!-- Dashboard Content -->
      <main class="container-fluid py-4">
        <!-- Stats Cards -->
        <div class="row g-4 mb-4">
          <div class="container mt-3">
            <div class="d-flex justify-content-center gap-3">
              <!-- Search Bar -->

              <button
                class="btn btn-primary"
                type="clear"
                style="border-radius: 5px"
              >
                <a
                  href="/admin/products/add"
                  class="text-decoration-none text-white"
                  >Add Products</a
                >
              </button>
            </div>
          </div>
        </div>

        <!-- Charts and Activity -->
        <div class="row g-4 mb-4"></div>

        <!-- Recent Orders Table -->
        <div class="card">
          <div class="card-header">
            <h5 class="card-title mb-0">Products</h5>
          </div>
          <div class="card-body p-0">
            <div class="table-responsive">
              <table class="table table-bordered mb-0">
                <thead class="table-light">
                  <tr>
                    <th style="width: 150px">Product Name</th>
                    <th style="width: 200px">Description</th>
                    <th style="width: 100px">Brand</th>
                    <th style="width: 150px">Category</th>
                    <th style="width: 270px">Variants</th>
                    <th style="width: 100px">Actions</th>
                  </tr>
                </thead>
                <tbody>
                  <%if(productList.length>0){%>
                  <%productList.forEach((product)=>{%>
                  <tr>
                    <td>
                      <%=product.productName%>
                    </td>
                    <td>
                      <button
                        type="button"
                        class="btn text-decoration-underline"
                        data-bs-toggle="collapse"
                        data-bs-target="#demo_<%=product._id%>"
                      >
                        Description
                      </button>
                      <div id="demo_<%=product._id%>" class="collapse">
                        <%=product.description%>
                      </div>
                    </td>

                    <!-- <td><%=product.description%></td> -->
                    <td>
                      <%=product.brand%>
                    </td>
                    <td>
                      <%=product.category.categoryName%>
                    </td>
                    <td>
                      <button
                        type="button"
                        class="btn text-decoration-underline"
                        data-bs-toggle="collapse"
                        data-bs-target="#demo2_<%=product._id%>"
                      >
                        Variants
                      </button>
                      <div id="demo2_<%=product._id%>" class="collapse">
                        <ul class="list-group">
                          <% product.variants.forEach((variant, index) => { %>
                          <li class="list-group-item">
                            <strong
                              >Variant
                              <%= index + 1 %>:</strong
                            ><br />
                            Strap:
                            <%= variant.strapMaterial %>
                            -
                            <%= variant.strapColor %><br />
                            Dial:
                            <%= variant.dialColor %><br />
                            Case Size:
                            <%= variant.caseSize %><br />
                            Movement Type:
                            <%= variant.movementType %><br />
                            Case Material:<%= variant.caseMaterial %><br />
                            Stock:
                            <%= variant.stockQuantity %><br />
                            Actual Price: ₹<%= variant.actualPrice %><br />
                            Offer Price: ₹<%= variant.offerPrice %><br />
                            <div class="d-flex justify-content-between">
                              <a
                                href="/admin/products/variant/edit?productId=<%=product._id%>&variantId=<%=variant._id%>"
                                class="text-decoration-none"
                                >Edit</a
                              >
                              <%if(variant.isListed==true){%>
                              <a
                                href="/admin/products/variant/unlist?id=<%=variant._id%>"
                                class="text-decoration-none"
                                onclick="return confirm('Are you sure you want to unlist this variant?');"
                              >
                                Unlist</a
                              >
                              <%}else{%>
                              <a
                                href="/admin/products/variant/list?id=<%=variant._id%>"
                                class="text-decoration-none"
                                onclick="return confirm('Are you sure you want to list this variant?');"
                              >
                                List</a
                              >
                              <%}%>
                            </div>
                          </li>
                          <% }) %>
                        </ul>
                      </div>
                    </td>
                    <td>
                      <div class="d-flex flex-column align-items-center">
                      <!-- Edit Product -->
                      <a
                        href="/admin/products/edit?id=<%=product._id%>"
                        class="text-decoration-none text-decoration-none text-dark btn btn-outline-secondary"
                        >Edit</a
                      ><br>
                      <!-- Edit Product -->

                      <!-- List & Unlist Product -->
                      <%if(product.isListed==true){%>
                      <a
                        href="/admin/products/unlist?id=<%=product._id%>"
                        class="text-decoration-none text-dark btn btn-outline-secondary"
                        onclick="return confirm('Are you sure you want to unlist <%=product.productName%>?');"
                      >
                        Unlist</a
                      >
                      <%}else{%>
                      <a
                        href="/admin/products/list?id=<%=product._id%>"
                        class="text-decoration-none text-dark btn btn-outline-secondary"
                        onclick="return confirm('Are you sure you want to list <%=product.productName%>?');"
                      >
                        List</a
                      >
                      <%}%>
                      <!-- List & Unlist Product -->
                       </div>
                    </td>
                  </tr>
                  <%})%>
                  <%}else{%>
                  <tr>
                    <td colspan="5" style="text-align: center">
                      No users found
                    </td>
                  </tr>
                  <%}%>
                </tbody>
              </table>
            </div>
          </div>
        </div>
      </main>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
    <script src="/js2/demo.js"></script>
  </body>
</html>
